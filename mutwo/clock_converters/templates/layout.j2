
indent = 0
ragged-right = ##t
ragged-last = ##t

\context {
  \Score
  \omit BarLine
  % DEACTIVATED: Remove all-rest staves also in the first system
  % \override VerticalAxisGroup.remove-first = ##t
  % If only one non-empty staff in a system exists, still print the starting bar
  \override SystemStartBar.collapse-height = #1
  % Avoid bar lines from time signatures of other staff groups
  % (move them to Staff context).
  \remove "Default_bar_line_engraver"
  % Allow breaks between bar lines
  % (this is important because we have)
  % (only very few bar lines).
  % !forbidBreakBetweenBarLines = ##f
  % !forbidBreakBetweenBarLines doesn't exist yet in 2.22,
  % !it's only available from 2.23. Once migrated to next
  % !stable release I should remove the 'barAlways' and use
  % !forbidBreakBetweenBarLines !
  barAlways = ##t
  % Arpeggi across staves
  \consists "Span_arpeggio_engraver"
  % PROPORTIONAL NOTATION!!
  proportionalNotationDuration = #(ly:make-moment 1/{{ moment }})
  \override SpacingSpanner.uniform-stretching = ##t
  % Deactivate: leads to unequal results (maybe only useful in
  % combination with 'strict-note-spacing'? But activating this
  % completely breaks clock scores..)
  \override SpacingSpanner.strict-grace-spacing = ##t
  \override Beam.breakable = ##t
  \override Glissando.breakable = ##t
  \override TextSpanner.breakable = ##t
  \override PaperColumn.used = ##t
  {% if move_timing_translator %}
  \remove "Timing_translator"
  {% endif %}
  \override BarNumber.break-visibility = #all-invisible
  connectArpeggios = ##t
  % We need clefs AFTER bar lines, not before them
  %     https://www.mail-archive.com/lilypond-user@gnu.org/msg125397.html
  \override BreakAlignment #'break-align-orders = #(make-vector 3 '(staff-bar clef))
  % We don't want to see a single bar line at the end of a line.
  % We need to set the default bar line (glyph-name), otherwise we'll
  % catch an exception.
  \override BarLine.glyph-name = "|"
  \override BarLine.break-visibility = #end-of-line-invisible
}

\context {
  \StaffGroup
  \omit BarLine

  \override StaffGrouper.staff-staff-spacing.basic-distance = #1
  \override StaffGrouper.staff-staff-spacing.minimum-distance = #1
  \override StaffGrouper.staff-staff-spacing.padding = #1
  \override StaffGrouper.staff-staff-spacing.stretchability = #0

  \override StaffGrouper.staffgroup-staff-spacing.basic-distance = #6
  \override StaffGrouper.staffgroup-staff-spacing.minimum-distance = #5
  \override StaffGrouper.staffgroup-staff-spacing.padding = #1
  \override StaffGrouper.staffgroup-staff-spacing.stretchability = #1
}

\context {
  \Staff
  \omit BarLine
  \omit TimeSignature
  {% if move_timing_translator %}
  \consists "Timing_translator"
  {% endif %}
  \consists "Default_bar_line_engraver"
  \remove "Separating_line_group_engraver"
  {% if remove_empty_staves %}
  \RemoveEmptyStaves
  {% endif %}
  \override BarLine.allow-span-bar = ##f
  \override Clef.break-visibility = #all-invisible
  \override ClefModifier.break-visibility = #all-invisible
  % We don't want to see cautionary clefs in the line before
  % a new event placed.
  % https://lists.gnu.org/archive/html/lilypond-user/2019-05/msg00124.html
  explicitClefVisibility = #end-of-line-invisible
}

\context {
  \Voice
  % Allow line breaks with tied notes
  \remove Forbid_line_break_engraver
}
